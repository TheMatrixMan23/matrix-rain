<!DOCTYPE html>
<html>
<head>
<title>Audio Visualizer</title>
<style>
body {
  background-color: black;
  margin: 0;
  overflow: hidden;
  color: white; /* Text color for sliders */
}

#canvas {
  display: block;
}

#controls {
  position: absolute;
  top: 10px;
  left: 10px;
  z-index: 10; /* Ensure controls are on top */
}

input[type="range"] {
  width: 200px;
}

label {
    display: block; /* Makes labels stack nicely */
    margin-bottom: 5px;
}

</style>
</head>
<body>

<canvas id="canvas"></canvas>
<audio id="audio" controls style="display:none;"></audio>

<div id="controls">
    <label for="spikeThreshold">Spike Threshold Multiplier:</label>
    <input type="range" id="spikeThreshold" min="1.0" max="5.0" step="0.1" value="2.0">
    <span id="spikeThresholdValue">2.0</span>

    <label for="kickCooldown">Kick Cooldown (ms):</label>
    <input type="range" id="kickCooldown" min="50" max="500" step="10" value="150">
    <span id="kickCooldownValue">150</span>

    <label for="frequencyRange">Frequency Range (e.g., 20-50):</label>
    <input type="text" id="frequencyRange" value="20-50">
</div>


<script>
// ... (rest of the JavaScript code as before, with modifications below)

// Get slider elements
const spikeThresholdSlider = document.getElementById('spikeThreshold');
const kickCooldownSlider = document.getElementById('kickCooldown');
const frequencyRangeInput = document.getElementById('frequencyRange');

// Get display elements for values
const spikeThresholdValueDisplay = document.getElementById('spikeThresholdValue');
const kickCooldownValueDisplay = document.getElementById('kickCooldownValue');


let spikeThresholdMultiplier = parseFloat(spikeThresholdSlider.value); // Initialize
let kickCooldown = parseInt(kickCooldownSlider.value); // Initialize
let frequencyRange = frequencyRangeInput.value;

// Event listeners for sliders
spikeThresholdSlider.addEventListener('input', () => {
    spikeThresholdMultiplier = parseFloat(spikeThresholdSlider.value);
    spikeThresholdValueDisplay.textContent = spikeThresholdSlider.value;
});

kickCooldownSlider.addEventListener('input', () => {
    kickCooldown = parseInt(kickCooldownSlider.value);
    kickCooldownValueDisplay.textContent = kickCooldownSlider.value;
});

frequencyRangeInput.addEventListener('input', () => {
    frequencyRange = frequencyRangeInput.value;
});



function detectKick() {
  const currentTime = audio.currentTime * 1000;

  const [startFreq, endFreq] = frequencyRange.split('-').map(Number); // Parse frequency range
  let currentLowFrequencyValue = analyzeFrequencyRange(startFreq, endFreq);

  let spikeDetected = false;
  const averagePrevious = previousLowFrequencyValues.reduce((a, b) => a + b, 0) / previousLowFrequencyValues.length;
  if (currentLowFrequencyValue > averagePrevious * spikeThresholdMultiplier) {
      spikeDetected = true;
  }

  previousLowFrequencyValues.shift();
  previousLowFrequencyValues.push(currentLowFrequencyValue);

  if (spikeDetected && currentTime - lastKickTime > kickCooldown) {
    lastKickTime = currentTime;
    return true;
  }

  return false;
}

// ... (rest of the JavaScript code)

</script>

</body>
</html>
